Index: TP3_Render.js
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>TP3.Render = {\r\n\tdrawTreeRough: function (rootNode, scene, alpha, radialDivisions = 8, leavesCutoff = 0.1, leavesDensity = 10, matrix = new THREE.Matrix4()) {\r\n\t\tvar stack = [];\r\n\t\tvar cylinderGeometries = [];\r\n\t\tvar leafGeometries = [];\r\n\r\n\t\tconst branchMaterial = new THREE.MeshLambertMaterial({color : 0x8B5A2B});\r\n\t\tconst leafMaterial = new THREE.MeshPhongMaterial({color : 0x3A5F0B});\r\n\r\n\t\tstack.push(rootNode);\r\n\r\n\t\twhile (stack.length > 0) {\r\n\t\t\tvar currentNode = stack.pop();\r\n\r\n\t\t\tfor (var i = 0; i < currentNode.childNode.length; i++) {\r\n\t\t\t\tstack.push(currentNode.childNode[i]);\r\n\t\t\t}\r\n\r\n\t\t\tvar middleVec = currentNode.p1.add(currentNode.p0).multiplyScalar(0.5);\r\n\r\n\t\t\tvar dist = currentNode.p0.distanceTo(currentNode.p1);\r\n\t\t\tvar cylinderGeometry = new THREE.CylinderBufferGeometry(currentNode.a0, currentNode.a1,\r\n\t\t\t\tdist, radialDivisions);\r\n\r\n\t\t\tcylinderGeometry.rotateX(Math.PI / 2);\r\n\r\n\t\t\tvar p0moinsp1 = new THREE.Vector3();\r\n\t\t\tp0moinsp1.add(currentNode.p0);\r\n\t\t\tp0moinsp1.sub(currentNode.p1);\r\n\t\t\tcylinderGeometry.lookAt(p0moinsp1);\r\n\r\n\t\t\tvar translate = new THREE.Matrix4();\r\n\t\t\ttranslate.makeTranslation(middleVec.x, middleVec.y, middleVec.z);\r\n\t\t\tcylinderGeometry.applyMatrix4(translate);\r\n\r\n\t\t\t// Feuilles\r\n\t\t\tif ((currentNode.a0 < alpha * leavesCutoff) || (currentNode.childNode.length == 0)) {\r\n\t\t\t\tfor (i = 0; i < leavesDensity; i++) {\r\n\t\t\t\t\tvar leafGeometry = new THREE.PlaneBufferGeometry(alpha, alpha);\r\n\t\t\t\t\tvar rotation = Math.random() * 2 * Math.PI;\r\n\t\t\t\t\tleafGeometry.rotateX(rotation);\r\n\t\t\t\t\tleafGeometry.rotateY(rotation);\r\n\t\t\t\t\tleafGeometry.rotateZ(rotation);\r\n\r\n\t\t\t\t\tvar posNeg;\r\n\t\t\t\t\tif (Math.random() < 0.5) {\r\n\t\t\t\t\t\tposNeg = 1;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tposNeg = -1;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar radius = ((alpha / 2) * Math.random()) * posNeg;\r\n\t\t\t\t\tvar radiusVector= new THREE.Vector3();\r\n\t\t\t\t\tradiusVector = p0moinsp1.normalize().cross(new THREE.Vector3(0, 0, 1)).normalize();\r\n\t\t\t\t\tradiusVector.multiplyScalar(radius);\r\n\r\n\t\t\t\t\tvar transX;\r\n\t\t\t\t\tvar transY;\r\n\t\t\t\t\tvar transZ;\r\n\t\t\t\t\tvar p0moinsp1plusalpha = p0moinsp1.multiplyScalar(1+(alpha/p0moinsp1.length()));\r\n\r\n\t\t\t\t\t// Je fais la translation vers middleVec et non currentNode.p0 parce que sinon les branches dépassent malgré le (p0-p1) * (1+alpha\r\n\t\t\t\t\tif (currentNode.a0 < alpha * leavesCutoff) {\r\n\t\t\t\t\t\ttransX = currentNode.p0.x + (p0moinsp1.x * Math.random()) + radiusVector.x;\r\n\t\t\t\t\t\ttransY = currentNode.p0.y + (p0moinsp1.y * Math.random()) + radiusVector.y;\r\n\t\t\t\t\t\ttransZ = currentNode.p0.z + (p0moinsp1.z * Math.random()) + radiusVector.z;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttransX = currentNode.p0.x + (p0moinsp1plusalpha.x * Math.random()) + radiusVector.x;\r\n\t\t\t\t\t\ttransY = currentNode.p0.y + (p0moinsp1plusalpha.y * Math.random()) + radiusVector.y;\r\n\t\t\t\t\t\ttransZ = currentNode.p0.z + (p0moinsp1plusalpha.z * Math.random()) + radiusVector.z;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ttranslate.makeTranslation(transX, transY, transZ);\r\n\t\t\t\t\tleafGeometry.applyMatrix4(translate);\r\n\r\n\t\t\t\t\tleafGeometries.push(leafGeometry);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tcylinderGeometries.push(cylinderGeometry);\r\n\t\t}\r\n\r\n\t\tvar cylinderMergedGeometries = THREE.BufferGeometryUtils.mergeBufferGeometries(cylinderGeometries);\r\n\t\tvar leafMergedGeometries = THREE.BufferGeometryUtils.mergeBufferGeometries(leafGeometries);\r\n\t\tvar cylinders = new THREE.Mesh(cylinderMergedGeometries, branchMaterial);\r\n\t\tvar leaves = new THREE.Mesh(leafMergedGeometries, leafMaterial);\r\n\t\tscene.add(cylinders);\r\n\t\tscene.add(leaves);\r\n\t},\r\n\t\r\n\tdrawTreeHermite: function (rootNode, scene, alpha, leavesCutoff = 0.1, leavesDensity = 10, matrix = new THREE.Matrix4()) {\r\n\t\t//TODO\r\n\t},\r\n\t\r\n\tupdateTreeHermite: function (trunkGeometryBuffer, leavesGeometryBuffer, rootNode) {\r\n\t\t//TODO\r\n\t},\r\n\t\r\n\tdrawTreeSkeleton: function (rootNode, scene, color = 0xffffff, matrix = new THREE.Matrix4()) {\r\n\t\tconsole.log(rootNode);\r\n\t\tvar stack = [];\r\n\t\tstack.push(rootNode);\r\n\t\t\t\r\n\t\tvar points = [];\r\n\t\t\r\n\t\twhile (stack.length > 0) {\r\n\t\t\tvar currentNode = stack.pop();\r\n\t\t\t\r\n\t\t\tfor (var i=0; i<currentNode.childNode.length; i++) {\r\n\t\t\t\tstack.push(currentNode.childNode[i]);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tpoints.push(currentNode.p0);\r\n\t\t\tpoints.push(currentNode.p1);\r\n\r\n\t\t\tconsole.log(currentNode.p0.distanceTo(currentNode.p1));\r\n\t\t}\r\n\t\t\r\n\t\tvar geometry = new THREE.BufferGeometry().setFromPoints(points);\r\n\t\tvar material = new THREE.LineBasicMaterial({color: color});\r\n\t\tvar line = new THREE.LineSegments(geometry, material);\r\n\t\tline.applyMatrix4(matrix);\r\n\t\tscene.add(line);\r\n\t\t\r\n\t\treturn line.geometry;\r\n\t},\r\n\r\n\tupdateTreeSkeleton: function (geometryBuffer, rootNode) {\r\n\t\t\r\n\t\tvar stack = [];\r\n\t\tstack.push(rootNode);\r\n\t\t\r\n\t\tvar idx = 0;\r\n\t\twhile (stack.length > 0) {\r\n\t\t\tvar currentNode = stack.pop();\r\n\t\t\t\r\n\t\t\tfor (var i=0; i<currentNode.childNode.length; i++) {\r\n\t\t\t\tstack.push(currentNode.childNode[i]);\r\n\t\t\t}\r\n\t\t\tgeometryBuffer[idx * 6] = currentNode.p0.x;\r\n\t\t\tgeometryBuffer[idx * 6 + 1] = currentNode.p0.y;\r\n\t\t\tgeometryBuffer[idx * 6 + 2] = currentNode.p0.z;\r\n\t\t\tgeometryBuffer[idx * 6 + 3] = currentNode.p1.x;\r\n\t\t\tgeometryBuffer[idx * 6 + 4] = currentNode.p1.y;\r\n\t\t\tgeometryBuffer[idx * 6 + 5] = currentNode.p1.z;\r\n\t\t\t\r\n\t\t\tidx++;\r\n\t\t}\r\n\t},\r\n\t\r\n\t\r\n\tdrawTreeNodes: function (rootNode, scene, color = 0x00ff00, size = 0.05, matrix = new THREE.Matrix4()) {\r\n\t\t\r\n\t\tvar stack = [];\r\n\t\tstack.push(rootNode);\r\n\t\t\t\r\n\t\tvar points = [];\r\n\t\t\r\n\t\twhile (stack.length > 0) {\r\n\t\t\tvar currentNode = stack.pop();\r\n\t\t\t\r\n\t\t\tfor (var i=0; i<currentNode.childNode.length; i++) {\r\n\t\t\t\tstack.push(currentNode.childNode[i]);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tpoints.push(currentNode.p0);\r\n\t\t\tpoints.push(currentNode.p1);\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\tvar geometry = new THREE.BufferGeometry().setFromPoints(points);\r\n\t\tvar material = new THREE.PointsMaterial({color: color, size: size});\r\n\t\tvar points = new THREE.Points(geometry, material);\r\n\t\tpoints.applyMatrix4(matrix);\r\n\t\tscene.add(points);\r\n\t\t\r\n\t},\r\n\t\r\n\t\r\n\tdrawTreeSegments: function (rootNode, scene, lineColor = 0xff0000, segmentColor = 0xffffff, orientationColor = 0x00ff00, matrix = new THREE.Matrix4()) {\r\n\t\t\r\n\t\tvar stack = [];\r\n\t\tstack.push(rootNode);\r\n\t\t\t\r\n\t\tvar points = [];\r\n\t\tvar pointsS = [];\r\n\t\tvar pointsT = [];\r\n\t\t\r\n\t\twhile (stack.length > 0) {\r\n\t\t\tvar currentNode = stack.pop();\r\n\t\t\t\r\n\t\t\tfor (var i=0; i<currentNode.childNode.length; i++) {\r\n\t\t\t\tstack.push(currentNode.childNode[i]);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tconst segments = currentNode.sections;\r\n\t\t\tfor (var i=0; i<segments.length-1; i++) {\r\n\t\t\t\tpoints.push(TP3.Geometry.meanPoint(segments[i]));\r\n\t\t\t\tpoints.push(TP3.Geometry.meanPoint(segments[i+1]));\r\n\t\t\t}\r\n\t\t\tfor (var i=0; i<segments.length; i++) {\r\n\t\t\t\tpointsT.push(TP3.Geometry.meanPoint(segments[i]));\r\n\t\t\t\tpointsT.push(segments[i][0]);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tfor (var i=0; i<segments.length; i++) {\r\n\t\t\t\t\r\n\t\t\t\tfor (var j=0; j<segments[i].length-1; j++) {\r\n\t\t\t\t\tpointsS.push(segments[i][j]);\r\n\t\t\t\t\tpointsS.push(segments[i][j+1]);\r\n\t\t\t\t}\r\n\t\t\t\tpointsS.push(segments[i][0]);\r\n\t\t\t\tpointsS.push(segments[i][segments[i].length-1]);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tvar geometry = new THREE.BufferGeometry().setFromPoints(points);\r\n\t\tvar geometryS = new THREE.BufferGeometry().setFromPoints(pointsS);\r\n\t\tvar geometryT = new THREE.BufferGeometry().setFromPoints(pointsT);\r\n\r\n\t\tvar material = new THREE.LineBasicMaterial({color: lineColor});\r\n\t\tvar materialS = new THREE.LineBasicMaterial({color: segmentColor});\r\n\t\tvar materialT = new THREE.LineBasicMaterial({color: orientationColor});\r\n\t\t\r\n\t\tvar line = new THREE.LineSegments(geometry, material);\r\n\t\tvar lineS = new THREE.LineSegments(geometryS, materialS);\r\n\t\tvar lineT = new THREE.LineSegments(geometryT, materialT);\r\n\t\t\r\n\t\tline.applyMatrix4(matrix);\r\n\t\tlineS.applyMatrix4(matrix);\r\n\t\tlineT.applyMatrix4(matrix);\r\n\t\t\r\n\t\tscene.add(line);\r\n\t\tscene.add(lineS);\r\n\t\tscene.add(lineT);\r\n\t\t\r\n\t}\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- TP3_Render.js	(revision fb5361a9f4ce9004c350f82a7d96ab258bac75a4)
+++ TP3_Render.js	(date 1606162418751)
@@ -59,7 +59,6 @@
 					var transZ;
 					var p0moinsp1plusalpha = p0moinsp1.multiplyScalar(1+(alpha/p0moinsp1.length()));
 
-					// Je fais la translation vers middleVec et non currentNode.p0 parce que sinon les branches dépassent malgré le (p0-p1) * (1+alpha
 					if (currentNode.a0 < alpha * leavesCutoff) {
 						transX = currentNode.p0.x + (p0moinsp1.x * Math.random()) + radiusVector.x;
 						transY = currentNode.p0.y + (p0moinsp1.y * Math.random()) + radiusVector.y;
Index: .idea/workspace.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project version=\"4\">\n  <component name=\"BranchesTreeState\">\n    <expand>\n      <path>\n        <item name=\"ROOT\" type=\"e8cecc67:BranchNodeDescriptor\" />\n        <item name=\"LOCAL_ROOT\" type=\"e8cecc67:BranchNodeDescriptor\" />\n      </path>\n      <path>\n        <item name=\"ROOT\" type=\"e8cecc67:BranchNodeDescriptor\" />\n        <item name=\"REMOTE_ROOT\" type=\"e8cecc67:BranchNodeDescriptor\" />\n      </path>\n      <path>\n        <item name=\"ROOT\" type=\"e8cecc67:BranchNodeDescriptor\" />\n        <item name=\"REMOTE_ROOT\" type=\"e8cecc67:BranchNodeDescriptor\" />\n        <item name=\"GROUP_NODE:origin\" type=\"e8cecc67:BranchNodeDescriptor\" />\n      </path>\n    </expand>\n    <select />\n  </component>\n  <component name=\"ChangeListManager\">\n    <list default=\"true\" id=\"dc92d315-27a3-4710-824a-511357c42901\" name=\"Default Changelist\" comment=\"\">\n      <change beforePath=\"$PROJECT_DIR$/.idea/workspace.xml\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/.idea/workspace.xml\" afterDir=\"false\" />\n      <change beforePath=\"$PROJECT_DIR$/TP3_Render.js\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/TP3_Render.js\" afterDir=\"false\" />\n    </list>\n    <option name=\"SHOW_DIALOG\" value=\"false\" />\n    <option name=\"HIGHLIGHT_CONFLICTS\" value=\"true\" />\n    <option name=\"HIGHLIGHT_NON_ACTIVE_CHANGELIST\" value=\"false\" />\n    <option name=\"LAST_RESOLUTION\" value=\"IGNORE\" />\n  </component>\n  <component name=\"Git.Settings\">\n    <option name=\"RECENT_GIT_ROOT_PATH\" value=\"$PROJECT_DIR$\" />\n  </component>\n  <component name=\"ProjectId\" id=\"1kNy0KjH8qbsHtMwTHoz4mty8IS\" />\n  <component name=\"ProjectViewState\">\n    <option name=\"hideEmptyMiddlePackages\" value=\"true\" />\n    <option name=\"showLibraryContents\" value=\"true\" />\n  </component>\n  <component name=\"PropertiesComponent\">\n    <property name=\"ASKED_SHARE_PROJECT_CONFIGURATION_FILES\" value=\"true\" />\n    <property name=\"RunOnceActivity.OpenProjectViewOnStart\" value=\"true\" />\n    <property name=\"SHARE_PROJECT_CONFIGURATION_FILES\" value=\"true\" />\n    <property name=\"WebServerToolWindowFactoryState\" value=\"false\" />\n    <property name=\"last_opened_file_path\" value=\"$PROJECT_DIR$\" />\n    <property name=\"node.js.detected.package.eslint\" value=\"true\" />\n    <property name=\"node.js.detected.package.tslint\" value=\"true\" />\n    <property name=\"node.js.path.for.package.eslint\" value=\"project\" />\n    <property name=\"node.js.path.for.package.tslint\" value=\"project\" />\n    <property name=\"node.js.selected.package.eslint\" value=\"(autodetect)\" />\n    <property name=\"node.js.selected.package.tslint\" value=\"(autodetect)\" />\n    <property name=\"nodejs_package_manager_path\" value=\"npm\" />\n    <property name=\"settings.editor.selected.configurable\" value=\"preferences.editor\" />\n    <property name=\"vue.rearranger.settings.migration\" value=\"true\" />\n  </component>\n  <component name=\"SpellCheckerSettings\" RuntimeDictionaries=\"0\" Folders=\"0\" CustomDictionaries=\"0\" DefaultDictionary=\"application-level\" UseSingleDictionary=\"true\" transferred=\"true\" />\n  <component name=\"TaskManager\">\n    <task active=\"true\" id=\"Default\" summary=\"Default task\">\n      <changelist id=\"dc92d315-27a3-4710-824a-511357c42901\" name=\"Default Changelist\" comment=\"\" />\n      <created>1605555121823</created>\n      <option name=\"number\" value=\"Default\" />\n      <option name=\"presentableId\" value=\"Default\" />\n      <updated>1605555121823</updated>\n      <workItem from=\"1605555123980\" duration=\"24510000\" />\n      <workItem from=\"1605802994664\" duration=\"18565000\" />\n      <workItem from=\"1605986110392\" duration=\"40641000\" />\n    </task>\n    <servers />\n  </component>\n  <component name=\"TypeScriptGeneratedFilesManager\">\n    <option name=\"version\" value=\"3\" />\n  </component>\n  <component name=\"Vcs.Log.Tabs.Properties\">\n    <option name=\"TAB_STATES\">\n      <map>\n        <entry key=\"MAIN\">\n          <value>\n            <State />\n          </value>\n        </entry>\n      </map>\n    </option>\n    <option name=\"oldMeFiltersMigrated\" value=\"true\" />\n  </component>\n  <component name=\"WindowStateProjectService\">\n    <state x=\"187\" y=\"127\" width=\"1540\" height=\"864\" key=\"MergeDialog\" timestamp=\"1605890836291\">\n      <screen x=\"0\" y=\"37\" width=\"1920\" height=\"1043\" />\n    </state>\n    <state x=\"187\" y=\"127\" width=\"1540\" height=\"864\" key=\"MergeDialog/0.37.1920.1043@0.37.1920.1043\" timestamp=\"1605890836291\" />\n    <state x=\"456\" y=\"194\" key=\"SettingsEditor\" timestamp=\"1605559851949\">\n      <screen x=\"0\" y=\"37\" width=\"1920\" height=\"1043\" />\n    </state>\n    <state x=\"456\" y=\"194\" key=\"SettingsEditor/0.37.1920.1043@0.37.1920.1043\" timestamp=\"1605559851949\" />\n    <state x=\"570\" y=\"173\" width=\"774\" height=\"773\" key=\"com.intellij.openapi.editor.actions.MultiplePasteAction$ClipboardContentChooser\" timestamp=\"1606001824532\">\n      <screen x=\"0\" y=\"37\" width=\"1920\" height=\"1043\" />\n    </state>\n    <state x=\"570\" y=\"173\" width=\"774\" height=\"773\" key=\"com.intellij.openapi.editor.actions.MultiplePasteAction$ClipboardContentChooser/0.37.1920.1043@0.37.1920.1043\" timestamp=\"1606001824532\" />\n    <state x=\"763\" y=\"474\" key=\"com.intellij.openapi.vcs.update.UpdateOrStatusOptionsDialogupdate-v2\" timestamp=\"1605890819352\">\n      <screen x=\"0\" y=\"37\" width=\"1920\" height=\"1043\" />\n    </state>\n    <state x=\"763\" y=\"474\" key=\"com.intellij.openapi.vcs.update.UpdateOrStatusOptionsDialogupdate-v2/0.37.1920.1043@0.37.1920.1043\" timestamp=\"1605890819352\" />\n    <state x=\"622\" y=\"257\" key=\"run.anything.popup\" timestamp=\"1605651814419\">\n      <screen x=\"0\" y=\"37\" width=\"1920\" height=\"1043\" />\n    </state>\n    <state x=\"622\" y=\"257\" key=\"run.anything.popup/0.37.1920.1043@0.37.1920.1043\" timestamp=\"1605651814419\" />\n    <state x=\"623\" y=\"267\" width=\"672\" height=\"678\" key=\"search.everywhere.popup\" timestamp=\"1606058648905\">\n      <screen x=\"0\" y=\"37\" width=\"1920\" height=\"1043\" />\n    </state>\n    <state x=\"623\" y=\"267\" width=\"672\" height=\"678\" key=\"search.everywhere.popup/0.37.1920.1043@0.37.1920.1043\" timestamp=\"1606058648905\" />\n  </component>\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- .idea/workspace.xml	(revision fb5361a9f4ce9004c350f82a7d96ab258bac75a4)
+++ .idea/workspace.xml	(date 1606498789560)
@@ -62,7 +62,8 @@
       <updated>1605555121823</updated>
       <workItem from="1605555123980" duration="24510000" />
       <workItem from="1605802994664" duration="18565000" />
-      <workItem from="1605986110392" duration="40641000" />
+      <workItem from="1605986110392" duration="41578000" />
+      <workItem from="1606433501607" duration="2389000" />
     </task>
     <servers />
   </component>
